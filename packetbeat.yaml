################### Packetbeat Agent configuration Example ######################

# This file contains an overview of various configuration settings. Please consult 
# the guide at <http://elastic.co/guide> for more details.

# Packetbeat is a distributed application monitoring that works
# by sniffing the network traffic between your application components.
#
#

############################# Agent ############################################
agent:

 # The name of the agent that publishes the network data. It can be used to group 
 # all the transactions sent by a single agent in the web interface.
 # If this options is not defined, the hostname is used.
 name:

 # The tags of the agent are included in their own field with each
 # transaction published. Tags make it easy to group servers by different
 # logical properties.
 #tags: ["service1"]

 # Uncomment the following if you want to ignore transactions created
 # by the server on which the agent is installed. This option is useful
 # to remove duplicates if agents are installed on multiple servers.
 # ignore_outgoing: true
 
############################# Sniffer ############################################

# Select the network interfaces to sniff the data. You can use the "any"
# keyword to sniff on all connected interfaces.
interfaces: 
 device: 'any'


# Configure the processes to be monitored and how to find them. The processes can
# be found by searching their command line by a given string.
procs:
  monitored:
    - process: mysqld
      cmdline_grep: mysqld

    - process: pgsql
      cmdline_grep: postgres

    - process: nginx
      cmdline_grep: nginx

    - process: app
      cmdline_grep: gunicorn

# Configure which protocols to monitor and the ports where they are
# running. You can disable a given protocol by commenting out its
# configuration.
protocols: 
  http:
    ports: [80, 8080, 8000, 5000, 8002]

  mysql:
    ports: [3306]

  pgsql:
    ports: [5432]

  redis:
    ports: [6379]

  thrift:
    ports: [9090]


############################# HTTP protocol ######################################
http:
  # Uncomment the following to hide certain parameters in URL or forms attached 
  # to HTTP requests. The names of the parameters are case insensitive. 
  # The value of the parameters will be replaced with the 'xxxxx' string.
  # This is generally useful for avoiding storing user passwords or other
  # sensitive information.
  hide_keywords: ['pass', 'password', 'passw']



############################# Output ############################################

# Configure what outputs to use when sending the data collected by packetbeat.
# You can enable one or multiple outputs by setting enabled option to true.
output:
  
  # Elasticsearch as output
  # Options:
  # host, port: where Elasticsearch is listening on
  # save_topology: specify if the topology is saved in Elasticsearch
  elasticsearch:
    enabled: true
    host: localhost
    port: 9200
    save_topology: true

  # Redis as output
  # Options:
  # host, port: where Redis is listening on
  # save_topology: specify if the topology is saved in Redis
  redis:
    enabled: false
    host: localhost
    port: 6379
    save_topology: true

  # File as output
  # Options
  # path: where to save the files
  # filename: name of the files
  # rotate_every_kb: maximum size of the files in path
  # number of files: maximum number of files in path
  file:
    enabled: false
    path: "/tmp/packetbeat"
    filename: packetbeat
    rotate_every_kb: 1000
    number_of_files: 7
